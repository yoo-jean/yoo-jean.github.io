---
title: 동시성 정리 노트 ⑥ 직렬화와 동시성 
date: 2026-01-15 10:00:00 +0900
categories: [CS, Concurrency]
tags: [serialization, concurrency, thread-safety]
---

이 장에서는 **직렬화**와 **동시성**이 각각 무엇인지,  
그리고 왜 함께 다룰 때 문제가 생길 수 있는지를 **일상적인 예시**로 풀어 설명한다.

---

## 6.1 직렬화란 무엇인가

### 직렬화의 개념

**직렬화(Serialization)** 란  
객체를 **저장하거나 전송할 수 있는 형태(바이트 데이터)** 로 바꾸는 것이다.

> 객체 = 메모리 속 살아있는 상태  
> 직렬화 = 그 상태를 사진 찍듯이 저장하는 것

### 예시

```java
class User {
    String name;
    int age;
}
```

이 객체는:
- 프로그램 실행 중 **메모리 안에만 존재**
- 그대로는 파일이나 네트워크로 보낼 수 없음

➡ 그래서  
**직렬화 → 바이트 데이터로 변환 → 저장 / 전송**

---

### 직렬화가 필요한 이유

1. **파일 저장**
  - 프로그램 종료 후에도 상태를 남기기 위해
2. **네트워크 전송**
  - 서버 ↔ 클라이언트 간 객체 전달
3. **프로세스 간 통신**
  - 서로 다른 실행 환경에서 데이터 공유

---

## 6.2 동시성 환경에서의 직렬화

여기서부터가 헷갈리기 쉬운 핵심이다.

---

### 동시성 환경이란?

- 여러 **스레드가 동시에**
- **하나의 객체**를 읽거나 수정하는 상황

```text
Thread A → 객체 값 변경 중
Thread B → 같은 객체를 직렬화 중
```

---

### 직렬화는 스레드 안전을 보장하지 않는다

**중요**

> 직렬화는  
> ❌ 스레드를 멈춰주지 않고  
> ❌ 객체 변경을 막아주지 않는다

즉,
- 직렬화는 그냥 **현재 상태를 그대로 읽을 뿐**
- 그 순간 다른 스레드가 값을 바꾸면? → 문제 발생

---

### 객체 상태 불일치 문제 (왜 위험한가)

#### 예시 상황

```java
class Account implements Serializable {
    int balance;
}
```

1. Thread A: `balance = 100` → `200`으로 변경 중
2. Thread B: 같은 시점에 직렬화 수행

결과:
- 저장된 값이 **100일 수도 있고**
- 중간 상태의 **깨진 데이터**일 수도 있음

➡ 이것이 **불완전한 직렬화 상태**

---


- 직렬화 = 사진 찍기
- 동시성 = 사람이 계속 움직임

사진 찍는 순간 사람이 움직이면?
- 흔들린 사진
- 이상한 자세

➡ **움직이지 않는 대상**이 가장 안전

---

### 불변 객체(Immutable)가 안전한 이유

**불변 객체**란?
- 생성 이후 **상태가 절대 바뀌지 않는 객체**

```java
class Point implements Serializable {
    final int x;
    final int y;
}
```

장점:
- 스레드가 몇 개든
- 직렬화 중이든
- 항상 **같은 상태**

➡ 동시성 + 직렬화 환경에서 **최고의 선택**

---

### Serializable 사용 시 주의사항 (현실적인 팁)

#### 1️. serialVersionUID
- 클래스 구조 변경 시 호환성 문제 방지
- 명시적으로 선언 권장

```java
private static final long serialVersionUID = 1L;
```

#### 2️. 민감 정보 주의
- 비밀번호, 토큰 등은 그대로 저장될 수 있음
- `transient` 사용 고려

```java
transient String password;
```

#### 3️. 깊은 객체 그래프 비용
- 객체 안에 객체가 많을수록
- 직렬화 비용과 위험 증가

---

## 핵심 문장 다시 이해하기

> 직렬화는 데이터 전달 문제이고,  
> 동시성은 상태 변경 문제다.

쉽게 말하면:

- 직렬화: **어떻게 옮길 것인가**
- 동시성: **언제 바뀌는가**

 둘은 **서로 다른 문제**   
 함께 쓰면 **의도적으로 설계하지 않으면 위험**

---

## 한 줄 요약

- 직렬화는 **상태를 저장하는 기술**
- 동시성은 **상태가 바뀌는 상황**
- **불변 객체 + 명확한 설계**가 답이다
